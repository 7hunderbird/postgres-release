---
name: pgbackrest

description: "Utility for PostgreSQL continuous archiving and point in time restore (PITR)"

templates:
  pre-start.sh.erb: bin/pre-start
  run.sh: bin/run
  backup.sh.erb: bin/backup.sh
  archive_wal.sh: bin/archive_wal.sh
  create_stanza.sh.erb: bin/create_stanza.sh
  config.sh.erb: config/config.sh
  pgbackrest.conf.erb: config/pgbackrest.conf

packages:
  - pgbackrest
  - perl-modules

consumes:
- name: database
  type: database
  optional: true

properties:
  pgbackrest.global_options_section:
    description: "A map of key/value pairs to include in the [global] section of the pgBackRest configuration file"
    example: |
      repo1-cipher-pass: "abcd"
      repo1-cipher-type: aes-256-cbc
  stanza.name:
    default: "postgres1"
  stanza.postgres.port:
    default: 5432
    description: "The database port (not used when using links)"
